<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<!-- namespace 命名空间
1、分类的作用，避免Sql语句重复
2、就是与我们JAVA接口关联
 -->
<mapper namespace="com.wys.work.accountingbillmag.mapper.AccountingBillMonthMapper">
	   
	<resultMap type="AccountingBillMonthBean" id="accMap">
		<id property="id" column="id" javaType="long"/>
		<result property="accountingBillCost" column="accounting_bill_cost" javaType="int"/>
		<result property="accountingBillMonth" column="accounting_bill_month" javaType="int"/>
		<result property="accountingBillCostPayMethod" column="accounting_bill_pay_method" javaType="int"/>
		<result property="accountingBillPayStatus" column="accounting_bill_pay_status" javaType="int"/>
		<result property="year" column="year" javaType="int"/>
		<association property="user" column="fk_user_id" javaType="UserBean" select="finduser"/>
	</resultMap>
	
	<resultMap type="UserBean" id="userMap">
		<id property="id" column="pk_id"/>
		<result property="userAcc" column="user_acc"/>
		<result property="userPwd" column="user_pwd"/>
		<result property="userName" column="user_name"/>
		<result property="userGender" column="user_gender"/>
		<result property="userTel" column="user_tel"/>
		<result property="userAddress" column="user_address"/>
		<result property="userIdcard" column="user_idcard"/>
		<result property="userZipcode" column="user_zipcode"/>
		<result property="userQq" column="user_qq"/>
	</resultMap>
	
	
	<!-- id属性定义着接口方法的名称 -->
		<!-- 在mybatis框架中，取值方式有2种：第一种是#{}，第二种是${}
		第一个区别在于：#取值的时候，会在参数的两侧添加''单引号
		然而$取值的时候，则不会添加''单引号
		第二个区别在于：#取值，编译方式采用预编译，$取值，编译方式直接才编译（可能会有
		SQL注入的危险）
		 -->

	<!-- map中取值，依旧还是采用#或者$,只是取值是采用：map.键的方式 -->
	
	<!-- resultType与resultMap一样，都是用来映射返回结果集与对象之间的关系
	只不过resultType需要结果集中字段名与对象的属性名保持名称一致 -->
	<select id="finduser" parameterType="Integer" resultMap="userMap">
		select * from t_user where id = #{id}
	</select>
	
	
	<select id="findAccounting2Count" parameterType="Map" resultType="int">
		select count(*) from t_accounting_bill a,t_user u 
		<where>
			a.fk_user_id = u.id
			<if test="idcard!=''">
				and u.user_name like "%"#{idcard}"%"
			</if>
			<if test="acc!=''">
				and u.user_acc like "%"#{acc}"%"
			</if>
			<if test="name!=''">
				and u.user_name like "%"#{name}"%"
			</if>
			<if test="year!=''">
				and a.year = #{year}
			</if>
		</where>
		limit #{index} , #{rows}
	</select>
	
	<select id="findAccounting2List" parameterType="Map" resultMap="accMap">
		select * from t_accounting_bill a,t_user u 
		<where>
			a.fk_user_id = u.id
			<if test="idcard!=''">
				and u.user_name like "%"#{idcard}"%"
			</if>
			<if test="acc!=''">
				and u.user_acc like "%"#{acc}"%"
			</if>
			<if test="name!=''">
				and u.user_name like "%"#{name}"%"
			</if>
			<if test="year!=''">
				and a.year = #{year}
			</if>
		</where>
		limit #{index} , #{rows}
	</select>
	 
	
</mapper>